!function(e){var t={};function s(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){e.exports=s(1)},function(e,t,s){"use strict";s.r(t);class i extends class{constructor(e,t={},s=!1){this.hostElement=e,this.saveBuffer=s,this.scenes=[],this.cameraWidth=10,this.fitMargin=10,this.options={},this.handleSettings(t),this.setupRootElement(),this.setupRenderer(),this.setupScenes(),this.setupStatic(),this.setupCamera(),this.setupControls(),this.setupHostElement(e),this.options.autoResize&&window.addEventListener("resize",this.onWindowResize.bind(this),!1)}handleSettings(e){this.options.enableZoom=void 0===e.enableZoom||e.enableZoom,this.options.enableRotate=void 0===e.enableRotate||e.enableRotate,this.options.enablePan=void 0===e.enablePan||e.enablePan,this.options.panSpeed=void 0===e.panSpeed?10:e.panSpeed,this.options.zoomSpeed=void 0===e.zoomSpeed?2.5:e.zoomSpeed,this.options.rotateSpeed=void 0===e.rotateSpeed?2.5:e.rotateSpeed,this.options.autoResize=void 0===e.autoResize||e.autoResize}load(e){this.clear(),this.setupScenes(),this.setupLights(),this.setupCamera(),this.setupControls();let t=this.setupVisualization(e);return this.fitToCanvas(),this.render(),this.animate(),t}loadJSON(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),200===t.status&&this.load(JSON.parse(t.responseText))}setupStatic(){}setupScenes(){this.scenes=[],this.scene=new THREE.Scene,this.scenes.push(this.scene)}clear(){this.clearScenes(),this.scenes=null,this.controls=null,this.camera=null,this.cornerPoints=null}clearScenes(){for(let e=0;e<this.scenes.length;++e){let t=this.scenes[e];for(t.traverse((function(e){let t=e.geometry,s=e.material,i=e.texture;t&&t.dispose(),s&&s.dispose(),i&&i.dispose()}));t.children.length;){let e=t.children[0];t.remove(e)}}}takeScreenShot(e){let t;try{let s="image/jpeg",i="image/octet-stream";t=this.renderer.domElement.toDataURL(s);let o=t.replace(s,i);e+=".jpg";let n=document.createElement("a");"string"==typeof n.download?(document.body.appendChild(n),n.download=e,n.href=o,n.click(),document.body.removeChild(n)):location.replace(uri)}catch(e){return void console.log(e)}}webglAvailable(){try{let e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}setupRenderer(){this.webglAvailable()?this.renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0,preserveDrawingBuffer:this.saveBuffer}):this.renderer=new THREE.CanvasRenderer({alpha:!0,antialias:!0,preserveDrawingBuffer:this.saveBuffer}),this.renderer.shadowMapEnabled=!1,this.renderer.shadowMapType=THREE.PCFSoftShadowMap,this.renderer.setSize(this.rootElement.clientWidth,this.rootElement.clientHeight),this.renderer.setClearColor(16777215,0),this.rootElement.appendChild(this.renderer.domElement),this.renderer.autoClear=!1}setupCamera(){let e=this.rootElement.clientWidth/this.rootElement.clientHeight,t=this.cameraWidth,s=t/e;this.camera=new THREE.OrthographicCamera(t/-2,t/2,s/2,s/-2,-100,1e3),this.camera.name="camera",this.camera.position.z=20}setupRootElement(){this.rootElement=document.createElement("div"),this.rootElement.style.width="100%",this.rootElement.style.height="100%",this.rootElement.style.position="relative"}setupHostElement(e){if(this.hostElement)for(;this.hostElement.firstChild;)this.hostElement.removeChild(this.hostElement.firstChild);e.appendChild(this.rootElement),this.resizeCanvasToHostElement()}changeHostElement(e){this.setupHostElement(e),this.fitToCanvas(),this.render()}setupControls(){let e=new THREE.OrthographicControls(this.camera,this.rootElement);e.rotateSpeed=this.options.rotateSpeed,e.zoomSpeed=this.options.zoomSpeed,e.panSpeed=this.options.panSpeed,e.enableZoom=this.options.enableZoom,e.enablePan=this.options.enablePan,e.enableRotate=this.options.enableRotate,e.staticMoving=!0,e.dynamicDampingFactor=.25,e.keys=[65,83,68],e.addEventListener("change",this.render.bind(this)),this.controls=e}fitToCanvas(){this.scenes.forEach(e=>e.updateMatrixWorld());let e=this.rootElement,t=e.clientWidth,s=e.clientHeight,i=[],o=new THREE.Vector3;for(let e=this.cornerPoints.geometry.vertices.length,t=0;t<e;++t){let e=this.cornerPoints.geometry.vertices[t].clone();this.cornerPoints.localToWorld(e),o.add(e)}o.multiplyScalar(1/this.cornerPoints.geometry.vertices.length);for(let e=this.cornerPoints.geometry.vertices.length,n=0;n<e;++n){let e=this.cornerPoints.geometry.vertices[n].clone();this.cornerPoints.localToWorld(e);this.camera.zoom;this.camera.zoom=this.options.zoomLevel,this.camera.updateProjectionMatrix();let a=o.sub(e);a.project(this.camera);let l=a.x<0,r=a.y<0;e.project(this.camera);let h=this.fitMargin,c=new THREE.Vector3(0,h,0),d=new THREE.Vector3(h,0,0);c.applyQuaternion(this.camera.quaternion),d.applyQuaternion(this.camera.quaternion),r?e.add(c):e.sub(c),l?e.add(d):e.sub(d),e.x=Math.round((e.x+1)*t/2),e.y=Math.round((1-e.y)*s/2),e.z=0,i.push(e)}let n=i[0].x,a=i[0].x,l=i[0].y,r=i[0].y;for(let e=i.length,t=0;t<e;++t){let e=i[t],s=e.x,o=e.y;s>a?a=s:s<n&&(n=s),o>r?r=o:o<l&&(l=o)}let h,c=t/(a-n),d=s/(r-l);c<=1&&d<=1||c>=1&&d>=1?h=Math.min(c,d):c<=1&&d>=1?h=c:d<=1&&c>=1&&(h=d),this.camera.zoom=h,this.camera.updateProjectionMatrix()}resizeCanvasToHostElement(){let e=this.rootElement.clientWidth/this.rootElement.clientHeight,t=this.cameraWidth,s=t/e;this.camera.left=-t/2,this.camera.right=t/2,this.camera.top=s/2,this.camera.bottom=-s/2,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.rootElement.clientWidth,this.rootElement.clientHeight),this.controls.handleResize(),this.render()}onWindowResize(){this.resizeCanvasToHostElement(),this.fitToCanvas(),this.render()}render(){this.renderer.clear();for(let e=0;e<this.scenes.length;++e){let t=this.scenes[e];this.renderer.render(t,this.camera),e!==this.scenes.length-1&&this.renderer.clearDepth()}}animate(){requestAnimationFrame(this.animate.bind(this)),this.controls.update()}createCylinder(e,t,s,i,o){var n=(new THREE.Vector3).subVectors(t,e);let a=n.length(),l=n.clone().divideScalar(a);var r=new THREE.ArrowHelper(l,e),h=new THREE.CylinderGeometry(s,s,a,i,0),c=new THREE.Mesh(h,o);return c.rotation.copy(r.rotation.clone()),c.position.copy((new THREE.Vector3).addVectors(e,n.multiplyScalar(.5))),c}rotateAroundWorldAxis(e,t,s){let i=new THREE.Matrix4;i.makeRotationAxis(t.normalize(),s),i.multiply(e.matrix),e.matrix=i,e.rotation.setFromRotationMatrix(e.matrix)}}{constructor(){super(...arguments),this.fitMargin=.5,this.axisLabels=[],this.wrapTolerance=.05,this.tagColorMap={adsorbates:"0xd70000",unknowns:"0xd75f00",interstitials:"0xaf8700",substitutions:"0x0087ff",outliers:"0x0087ff"},this.elementNames=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Ha","Sg","Ns","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts","Og"],this.elementNumbers={H:1,He:2,Li:3,Be:4,B:5,C:6,N:7,O:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,S:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103},this.missing=.2,this.elementRadii=[this.missing,.31,.28,1.28,.96,.84,.76,.71,.66,.57,.58,1.66,1.41,1.21,1.11,1.07,1.05,1.02,1.06,2.03,1.76,1.7,1.6,1.53,1.39,1.39,1.32,1.26,1.24,1.32,1.22,1.22,1.2,1.19,1.2,1.2,1.16,2.2,1.95,1.9,1.75,1.64,1.54,1.47,1.46,1.42,1.39,1.45,1.44,1.42,1.39,1.39,1.38,1.39,1.4,2.44,2.15,2.07,2.04,2.03,2.01,1.99,1.98,1.98,1.96,1.94,1.92,1.92,1.89,1.9,1.87,1.87,1.75,1.7,1.62,1.51,1.44,1.41,1.36,1.36,1.32,1.45,1.46,1.48,1.4,1.5,1.5,2.6,2.21,2.15,2.06,2,1.96,1.9,1.87,1.8,1.69,this.missing,this.missing,this.missing,this.missing,this.missing,this.missing,this.missing],this.elementColors=[16711680,16777215,14286847,13402367,12779264,16758197,9474192,3166456,16715021,9494608,11789301,11230450,9109248,12560038,1578e4,16744448,16777008,2093087,8442339,9388244,4062976,15132390,12567239,10921643,9083335,10255047,14706227,15765664,5296208,13140019,8224944,12750735,6721423,12419299,16752896,10889513,6076625,7351984,65280,9764863,9756896,7586505,5551541,3907230,2396047,687500,27013,12632256,16767375,10909043,6717568,10380213,13924864,9699476,4366e3,5707663,51456,7394559,16777159,14286791,13107143,10747847,9437127,6422471,4587463,3211207,2097095,65436,58997,54354,48952,43812,5096191,5089023,2200790,2522539,2516630,1528967,13684960,16765219,12105936,10900557,5724513,10375093,11230208,7688005,4358806,4325478,32e3,7384058,47871,41471,36863,33023,27647,5528818,7888099,9064419,10565332,11739092,11739066,11734438,12389767,13041766,13369433,13697103,14221381,14680120,15073326,15400998]}setupScenes(){this.scenes=[],this.sceneStructure=new THREE.Scene,this.scenes.push(this.sceneStructure),this.sceneInfo=new THREE.Scene,this.scenes.push(this.sceneInfo)}handleSettings(e){this.options.showParam=void 0===e.showParam||e.showParam,this.options.showLegend=void 0===e.showLegend||e.showLegend,this.options.showBonds=void 0===e.showBonds||e.showBonds,this.options.showShadows=void 0!==e.showShadows&&e.showShadows,this.options.showTags=void 0!==e.showTags&&e.showTags,this.options.showVacancies=void 0!==e.showVacancies&&e.showVacancies,this.options.showOptions=void 0===e.showOptions||e.showOptions,this.options.allowRepeat=void 0===e.allowRepeat||e.allowRepeat,this.options.showCopies=void 0!==e.showCopies&&e.showCopies,this.options.showCell=void 0===e.showCell||e.showCell,this.options.wrap=void 0===e.wrap||e.wrap,this.options.showUnit=void 0===e.showUnit||e.showUnit,this.options.radiusScale=void 0===e.radiusScale?1:e.radiusScale,this.options.bondScale=void 0===e.bondScale?1:e.bondScale,this.options.translation=void 0===e.translation?[0,0,0]:e.translation,this.options.zoomLevel=void 0===e.zoomLevel?1:e.zoomLevel,super.handleSettings(e)}setupVisualization(e){e.primitiveCell;let t=e.cell,s=e.scaledPositions,o=e.positions,n=e.atomicNumbers,a=e.chemicalSymbols,l=e.pbc,r=e.unit;this.tags=e.tags;let h=e.classification;if(!t)return console.log("No normalized cell given to the structure viewer"),!1;if(!s&&!o)return console.log("No atom positions given to the structure viewer"),!1;if(!n&&!a)return console.log("No atomicNumbers or chemicalSymbols given to the structure viewer."),!1;if(n||(n=a.map(e=>this.elementNumbers[e])),o&&o.length!=n.length)return console.log("The number of positions does not match the number of labels."),!1;if(s&&s.length!=n.length)return console.log("The number of scaled positions does not match the number of labels."),!1;if("Surface"!=h&&"Material2D"!=h&&"Class2D"!=h||(this.options.allowRepeat=!1,this.options.wrap=!1,this.options.showCopies=!1),this.options.showUnit&&null!=r&&null!=r){let e=document.createElement("div");e.style.position="fixed",e.style.top="5%",e.style.right="5%",e.style.width="25%",e.style.height="25%",this.rootElement.appendChild(e),this.unitDiv=e;let t=document.createElement("div");t.id="unitCanvas",t.style.width="100%",t.style["padding-top"]="100%",t.style.position="relative",e.appendChild(t);let s=document.createElement("div");s.style.position="absolute",s.style.top=0,s.style.left=0,s.style.bottom=0,s.style.right=0,t.appendChild(s),r.classification=h;let o=new i(s,!1,{showOptions:!1,showCopies:!1,show:!1,wrap:!1,showParam:!1,showLegend:!1});o.load(r),o.toggleElementLegend(!1)}null!=l&&null!=l||(l=[!0,!0,!0]),this.root=new THREE.Object3D,this.atoms=new THREE.Object3D,this.bonds=new THREE.Object3D,this.cellVectorLines=new THREE.Object3D,this.angleArcs=new THREE.Object3D,this.root.add(this.cellVectorLines),this.root.add(this.atoms),this.root.add(this.bonds),this.sceneStructure.add(this.root),this.basisVectors=this.createBasisVectors(t);let c=[],d=[];if(void 0!==s)for(let e=0;e<s.length;++e){let t=s[e],i=(new THREE.Vector3).fromArray(t),o=i.x,n=i.y,a=i.z;this.options.wrap&&(l[0]&&this.almostEqual(1,o,this.basisVectors[0],this.wrapTolerance)&&(o-=1),l[1]&&this.almostEqual(1,n,this.basisVectors[1],this.wrapTolerance)&&(n-=1),l[2]&&this.almostEqual(1,a,this.basisVectors[2],this.wrapTolerance)&&(a-=1)),i=new THREE.Vector3(o,n,a),c.push(i);let r=new THREE.Vector3;r.add(this.basisVectors[0].clone().multiplyScalar(i.x)),r.add(this.basisVectors[1].clone().multiplyScalar(i.y)),r.add(this.basisVectors[2].clone().multiplyScalar(i.z)),d.push(r)}else if(void 0!==o)for(let e=0;e<o.length;++e){let s=o[e],i=(new THREE.Vector3).fromArray(s);d.push(i);let n=new THREE.Matrix3;n.set(t[0][0],t[0][1],t[0][2],t[1][0],t[1][1],t[1][2],t[2][0],t[2][1],t[2][2]);let a=(new THREE.Matrix3).getInverse(n),l=i.clone().applyMatrix3(a);c.push(l)}let m=0,p=[],u=l[0],E=l[1],g=l[2];if(u&&E&&g)m=3;else if(u||E||g)for(let e=0;e<3;++e){let t=l[e],s=l[(e+1)%3],i=l[(e+2)%3];if(t&&!s&&!i){m=1,p.push(e);break}if(t&&s&&!i){m=2,p.push(e),p.push((e+1)%3);break}}else m=0;return 0===m&&this.setup0D(c,d,n),1===m?this.setup1D(c,d,n,l,p):2===m?this.setup2D(c,d,n,l,p):3===m&&this.setup3D(c,d,n),this.translate(this.options.translation),this.setZoom(this.options.zoomLevel),this.createVacancies(),this.createElementLegend(),this.optionsHandler(),!0}createVacancies(){if(this.tags){let e=this.tags.vacancies;if(e){let t=[],s=[];for(let i=0;i<e.length;++i){let o=e[i];t.push((new THREE.Vector3).fromArray(o.position)),s.push(o.label)}let i={};this.vacancyContainer=new THREE.Object3D,this.vacancyContainer.visible=!1;for(let e=t.length,o=0;o<e;++o){let e=t[o],n=s[o],a=this.createAtom(e,n,i),l=a[0];l.material.opacity=.25,l.material.transparent=!0;let r=a[1];r.material.opacity=.25,r.material.transparent=!0,this.vacancyContainer.add(l),this.vacancyContainer.add(r)}this.atoms.add(this.vacancyContainer)}}}setupStatic(){this.optionsHandler=function(){let e=this.options.showParam,t=this.options.showCell,s=this.options.showLegend,i=this.options.showBonds,o=this.options.showShadows,n=this.options.showTags,a=this.options.showVacancies,l=this.options.showOptions;this.toggleLatticeParameters(e),this.toggleCell(t),this.toggleElementLegend(s),this.toggleBonds(i),this.toggleShadows(o),this.toggleTags(n),this.toggleVacancies(a),this.toggleOptions(l)}.bind(this),this.datGui=new dat.GUI({autoPlace:!1,width:150}),this.datGui.domElement.id="datgui",this.datGui.domElement.style.display="None",this.datGui.close(),this.rootElement.appendChild(this.datGui.domElement),this.datGui.add(this.options,"showParam",!0).name("Lattice parameters").onChange(this.optionsHandler),this.datGui.add(this.options,"showCell",!0).name("Cell").onChange(this.optionsHandler),this.datGui.add(this.options,"showLegend",!0).name("Element labels").onChange(this.optionsHandler),this.datGui.add(this.options,"showBonds",!0).name("Bonds").onChange(this.optionsHandler),this.datGui.add(this.options,"showShadows",!1).name("Shadows").onChange(this.optionsHandler),this.datGui.add(this.options,"showTags",!1).name("Tags").onChange(this.optionsHandler),this.datGui.add(this.options,"showVacancies",!1).name("Vacancies").onChange(this.optionsHandler),this.datGui.add(this.options,"showOptions",!1).name("Options").onChange(this.optionsHandler);var e=document.createElement("div");e.id="elementlegend",this.elementLegend=e,this.rootElement.appendChild(e)}setupLights(){this.lights=[];let e=new THREE.DirectionalLight(16777215,.45);e.shadowMapWidth=2048,e.shadowMapHeight=2048,e.position.set(0,0,20),this.sceneStructure.add(e),this.lights.push(e);let t=new THREE.DirectionalLight(16777215,.3);t.shadowMapWidth=2048,t.shadowMapHeight=2048,t.position.set(-20,0,-20),this.sceneStructure.add(t),this.lights.push(t);let s=new THREE.DirectionalLight(16777215,.25);s.shadowMapWidth=2048,s.shadowMapHeight=2048,s.position.set(20,0,-20),this.sceneStructure.add(s),this.lights.push(s);let i=new THREE.AmbientLight(4210752,1.7);this.sceneStructure.add(i)}toggleElementLegend(e){this.elementLegend.style.display=e?"flex":"None"}toggleOptions(e){this.datGui.domElement.style.display=e?"block":"None"}toggleVacancies(e){this.vacancyContainer&&(this.vacancyContainer.visible=e,this.render())}toggleTags(e){if(this.tags){if(e)var t=this.tagColorMap.adsorbates,s=this.tagColorMap.substitutions,i=this.tagColorMap.interstitials,o=this.tagColorMap.unknowns,n=this.tagColorMap.outliers,a=1.15;else t=0,s=0,n=0,a=1;if(this.tags.additionals)for(let e=0;e<this.tags.additionals.length;++e){let t=this.tags.additionals[e],s=this.atomOutlines[t],i=s.material.clone();s.scale.set(a,a,a),i.color.setHex(n),s.material=i}if(this.tags.adsorbates)for(let e=0;e<this.tags.adsorbates.length;++e){let s=this.tags.adsorbates[e],i=this.atomOutlines[s],o=i.material.clone();i.scale.set(a,a,a),o.color.setHex(t),i.material=o}if(this.tags.substitutions)for(let e=0;e<this.tags.substitutions.length;++e){let t=this.tags.substitutions[e],i=this.atomOutlines[t],o=i.material.clone();i.scale.set(a,a,a),o.color.setHex(s),i.material=o}if(this.tags.interstitials)for(let e=0;e<this.tags.interstitials.length;++e){let t=this.tags.interstitials[e],s=this.atomOutlines[t],o=s.material.clone();s.scale.set(a,a,a),o.color.setHex(i),s.material=o}if(this.tags.unknowns)for(let e=0;e<this.tags.unknowns.length;++e){let t=this.tags.unknowns[e],s=this.atomOutlines[t],i=s.material.clone();s.scale.set(a,a,a),i.color.setHex(o),s.material=i}this.render()}}toggleLatticeParameters(e){this.latticeParameters.visible=e,this.cellVectorLines.visible=e,this.angleArcs.visible=e,this.render()}toggleCell(e){void 0!==this.convCell&&(this.convCell.visible=e),void 0!==this.primCell&&(this.primCell.visible=e),this.render()}toggleBonds(e){this.bonds.visible=e,this.render()}toggleShadows(e){this.renderer.shadowMapEnabled=e;for(let t=0;t<this.lights.length;++t){this.lights[t].castShadow=e}for(let t=0;t<this.atomFills.length;++t){let s=this.atomFills[t];s.receiveShadow=e,s.castShadow=e,s.material.needsUpdate=!0}for(let t=0;t<this.bondFills.length;++t){let s=this.bondFills[t];s.receiveShadow=e,s.castShadow=e,s.material.needsUpdate=!0}this.render(),this.render()}createElementLegend(){for(;this.elementLegend.firstChild;)this.elementLegend.removeChild(this.elementLegend.firstChild);let e=[];for(let t in this.elements)this.elements.hasOwnProperty(t)&&e.push([t,this.elements[t][0],this.elements[t][1]]);e.sort((function(e,t){let s=e[0],i=t[0];return s<i?-1:s>i?1:0}));for(let t=0;t<e.length;++t){let s=e[t][0],i=e[t][1].toString(16),o=6-i.length;i="#"+Array(o+1).join("0")+i;let n=50*e[t][2],a=document.createElement("div");a.className="elementlabel",a.style.backgroundColor=i,a.style.height=n+"px",a.style.width=n+"px",a.style.textAlign="center",a.style.verticalAlign="middle",a.style.lineHeight=n+"px",a.style.borderRadius=n/2+"px",a.textContent=s,this.elementLegend.appendChild(a)}}createLatticeParameters(e,t,s){this.latticeParameters=new THREE.Object3D,this.axisLabels=[],this.sceneInfo.add(this.latticeParameters),this.sceneInfo.add(this.angleArcs);let i=0;for(let e=0;e<t.length;++e)t[e]&&++i;function o(e,t,s,i=!0){let o=document.createElement("canvas");o.width=256,o.height=256;let n=o.getContext("2d");n.fillStyle=s,n.font="155px Arimo",n.textAlign="center",i&&(n.font="160px Arimo",n.lineWidth=8,n.strokeStyle="#000000",n.strokeText(t,128,128)),n.fillText(t,128,128);let a=new THREE.Texture(o);a.needsUpdate=!0;let l=new THREE.SpriteMaterial({map:a}),r=new THREE.Sprite(l);r.position.copy(e);return r.scale.set(1.5,1.5,1),r}new THREE.LineBasicMaterial({color:"#000000",linewidth:1.5});let n,a,l=["#C52929","#47A823","#3B5796"],r=-1,h=["a","b","c"],c=["γ","α","β"];2===i&&(n=s[0],a=s[1]);for(let s=0;s<3;++s){if(!t[s])continue;r+=1;let d,m,p,u=h[r],E=l[r],g=c[r],w=e[s],b=e[(s+1)%3].clone(),y=e[(s+2)%3].clone(),f=new THREE.Vector3(0,0,0),T=w.clone(),R=T.clone().multiplyScalar(.5);if(0==b.length())m=(new THREE.Vector3).crossVectors(w,y),d=(new THREE.Vector3).crossVectors(w,m);else if(0==y.length())p=(new THREE.Vector3).crossVectors(w,b),d=(new THREE.Vector3).crossVectors(w,y);else{let e=(new THREE.Vector3).crossVectors(w,b),t=(new THREE.Vector3).crossVectors(w,y);d=(new THREE.Vector3).sub(e).add(t)}if(d.normalize(),d.multiplyScalar(.8),R.add(d),3===i)u=o(R,u,E),this.latticeParameters.add(u),this.axisLabels.push(u);else if(2===i){let e=o(R,u,E);this.latticeParameters.add(e),this.axisLabels.push(e),g="γ"}else{let e=o(R,"a",E);this.latticeParameters.add(e),this.axisLabels.push(e)}let H=new THREE.MeshBasicMaterial({color:E,transparent:!0,opacity:.75}),v=w.clone(),V=this.createCylinder(f.clone(),v.clone().add(f),.09,10,H);this.latticeParameters.add(V);let C=new THREE.MeshBasicMaterial({color:"#000000"}),S=this.basisVectors[s].clone(),x=S.clone().multiplyScalar(1+1.3/S.length()),M=(w.clone(),this.createCylinder(f.clone(),x,.02,10,C));this.latticeParameters.add(M);let P=new THREE.CylinderGeometry(0,.1,.5,12),B=new THREE.MeshBasicMaterial({color:0}),A=new THREE.Mesh(P,B);if(A.position.copy(T).multiplyScalar(1+1.3/T.length()),A.lookAt(new THREE.Vector3),A.rotateX(-Math.PI/2),this.latticeParameters.add(A),1===i)continue;if(2===i&&(s!=n||(s+1)%3!=a))continue;let L=new THREE.LineDashedMaterial({color:0,linewidth:2,dashSize:.2,gapSize:.1}),O=(new THREE.Vector3).crossVectors(w,b),N=w.angleTo(b),z=Math.max(Math.min(1/4*w.length(),1/4*b.length()),1),j=new THREE.EllipseCurve(0,0,z,z,0,N,!1).getSpacedPoints(20),I=(new THREE.Geometry).setFromPoints(j),W=new THREE.Line(I,L);W.computeLineDistances();new THREE.Vector3(0,1,0);let D=new THREE.Vector3(1,0,0),G=(new THREE.Vector3(0,0,1),(new THREE.Quaternion).setFromUnitVectors(D,w.clone().normalize()));W.quaternion.copy(G);let F=I.vertices[I.vertices.length-1];W.updateMatrixWorld();let k=W.localToWorld(F.clone()),q=w,_=(new THREE.Vector3).crossVectors(q,k),U=O.angleTo(_);(new THREE.Vector3).crossVectors(b,k).dot(q)>0&&(U=-U),W.rotateX(U),W.updateMatrixWorld(),W.updateMatrix();let Q=W.localToWorld(I.vertices[9].clone()),Z=Q.length();Q.multiplyScalar(1+.3/Z);let K=o(Q,g.toString(),"#FFFFFF",!0);this.latticeParameters.add(K),this.axisLabels.push(K),this.angleArcs.add(W)}}createBasisVectors(e){let t=[];for(let s=e.length,i=0;i<s;++i){let s=e[i],o=(new THREE.Vector3).fromArray(s);t.push(o)}return t}createCornerPoints(e,t){var s=new THREE.Geometry;s.vertices.push(e);let i=e.clone().add(t[0]).add(t[1]).add(t[2]);s.vertices.push(i);for(let o=t.length,n=0;n<o;++n){let o=e.clone().add(t[n].clone());s.vertices.push(o);let a=i.clone().sub(o);s.vertices.push(a)}this.cornerPoints=new THREE.Points(s),this.cornerPoints.visible=!1,this.vizBasisVectors=t,this.vizOrigin=e,this.root.add(this.cornerPoints)}createConventionalCell(e,t){let s=this.createCell(new THREE.Vector3,this.basisVectors,e,0,1.5,!1);s.visible=t,this.convCell=s,this.root.add(this.convCell)}createPrimitiveCell(e,t){if(null!=this.primitiveVectors){let s=this.createCell(new THREE.Vector3,this.primitiveVectors,e,0,1.5,!0);s.visible=t,this.primCell=s,this.root.add(this.primCell)}}createCell(e,t,s,i,o,n){let a,l=new THREE.Object3D;a=n?new THREE.LineDashedMaterial({color:i,linewidth:o,dashSize:.1,gapSize:.1}):new THREE.LineBasicMaterial({color:i,linewidth:o});let r=new THREE.LineDashedMaterial({color:"#999999",linewidth:o,dashSize:.1,gapSize:.1}),h=!0;for(let e=0;e<3;++e){t[e].length()>.001&&!s[e]&&(h=!1)}for(let i=t.length,o=0;o<i;++o){let n=t[o].clone(),c=a.clone(),d=!s[o];if(!d||!h){d&&(c=r.clone());let t=new THREE.Geometry;t.vertices.push(e.clone(),n.clone().add(e));let s=new THREE.Line(t,c);l.add(s),s.computeLineDistances()}let m=t[(o+1)%i].clone(),p=!s[o]||!s[(o+1)%3];if(!p||!h){let t=a.clone();p&&(t=r.clone());let s=new THREE.Geometry;s.vertices.push(m.clone().add(e),n.clone().add(m).add(e));let i=new THREE.Line(s,t);l.add(i),i.computeLineDistances()}let u=t[(o+2)%i].clone(),E=!s[o]||!s[(o+2)%3];if(!E||!h){let t=a.clone();E&&(t=r.clone());let s=new THREE.Geometry;s.vertices.push(u.clone().add(e),n.clone().add(u).add(e));let i=new THREE.Line(s,t);l.add(i),i.computeLineDistances()}let g=!s[o]||!s[(o+2)%3]||!s[(o+1)%3];if(!g||!h){let t=a.clone();g&&(t=r.clone());let s=new THREE.Geometry;s.vertices.push(m.clone().add(u).add(e),n.clone().add(m).add(u).add(e));let i=new THREE.Line(s,t);l.add(i),i.computeLineDistances()}}return l}setupInitialView1D(e){let t;this.center(),this.root.updateMatrixWorld();for(let s=0;s<e.length;++s){e[s]&&(t=this.basisVectors[s])}let s=new THREE.Vector3(1,0,0),i=(new THREE.Quaternion).setFromUnitVectors(s,t.clone().normalize());i.conjugate(),this.root.quaternion.premultiply(i),this.sceneInfo.quaternion.premultiply(i);let o=new THREE.Vector3(0,1,0),n=new THREE.Vector3(1,0,0);n.applyQuaternion(this.camera.quaternion),o.applyQuaternion(this.camera.quaternion);let a=Math.PI/4;this.rotateAroundWorldAxis(this.root,o,a),this.rotateAroundWorldAxis(this.sceneInfo,o,a);let l=Math.PI/9;this.rotateAroundWorldAxis(this.root,n,l),this.rotateAroundWorldAxis(this.sceneInfo,n,l)}setupInitialView2D(e,t){this.center();let s=this.basisVectors[t[0]].clone(),i=[1,1,1];for(let e=0;e<t.length;++e){i[t[e]]=0}i=(new THREE.Vector3).fromArray(i),this.root.updateMatrixWorld();let o=new THREE.Vector3(0,0,1),n=(new THREE.Quaternion).setFromUnitVectors(i.clone().normalize(),o);this.root.quaternion.premultiply(n),this.sceneInfo.quaternion.premultiply(n),s=s.clone().applyQuaternion(n),i=i.clone().applyQuaternion(n),o=new THREE.Vector3(1,0,0),n=(new THREE.Quaternion).setFromUnitVectors(s.clone().normalize(),o),this.root.quaternion.premultiply(n),this.sceneInfo.quaternion.premultiply(n),this.root.updateMatrixWorld(),this.sceneInfo.updateMatrixWorld();let a=new THREE.Vector3(1,0,0);a.applyQuaternion(this.camera.quaternion);let l=-Math.PI/6;this.rotateAroundWorldAxis(this.root,a,l),this.rotateAroundWorldAxis(this.sceneInfo,a,l)}setupInitialView3D(){this.center();this.basisVectors[0];let e=this.basisVectors[1],t=this.basisVectors[2];this.root.updateMatrixWorld();let s=new THREE.Vector3(0,1,0),i=(new THREE.Quaternion).setFromUnitVectors(t.clone().normalize(),s);this.root.quaternion.premultiply(i),this.sceneInfo.quaternion.premultiply(i),this.root.updateMatrixWorld(),this.sceneInfo.updateMatrixWorld(),e=e.clone().applyQuaternion(i),t=t.clone().applyQuaternion(i);let o=(new THREE.Vector3).crossVectors(e,t),n=new THREE.Vector3(0,0,1),a=(new THREE.Quaternion).setFromUnitVectors(o.clone().normalize(),n);this.root.quaternion.premultiply(a),this.sceneInfo.quaternion.premultiply(a),this.root.updateMatrixWorld(),this.sceneInfo.updateMatrixWorld(),e=e.clone().applyQuaternion(a),t=t.clone().applyQuaternion(a);let l=new THREE.Vector3(0,0,-1);l.applyQuaternion(this.camera.quaternion);let r=(new THREE.Vector3).crossVectors(l,e);r.normalize();let h=-Math.PI/6;this.rotateAroundWorldAxis(this.root,r,h),this.rotateAroundWorldAxis(this.sceneInfo,r,h);let c=(new THREE.Vector3).crossVectors(l,t);c.normalize();let d=Math.PI/12;this.rotateAroundWorldAxis(this.root,c,d),this.rotateAroundWorldAxis(this.sceneInfo,c,d)}center(){let e=(new THREE.Vector3).add(this.vizBasisVectors[0]).add(this.vizBasisVectors[1]).add(this.vizBasisVectors[2]).multiplyScalar(.5),t=this.vizOrigin.clone().add(e).multiplyScalar(-1),s=this.root.children;for(let e=s.length,i=0;i<e;++i){s[i].position.add(t)}let i=this.sceneInfo.children;for(let e=i.length,s=0;s<e;++s){i[s].position.add(t)}}createAtoms(e,t,s){this.elements={},this.atomPos=[],this.atomNumbers=[],this.atomFills=[],this.atomOutlines=[];let i=this.basisVectors[0],o=this.basisVectors[1],n=this.basisVectors[2],a={};for(let l=e.length,r=0;r<l;++r){let l=e[r],h=t[r];this.addAtom(r,l,h,a);let c=this.elementNames[h-1];if(this.elements[c]=[this.elementColors[h],this.elementRadii[h]],s){let e=l.x,t=l.y,s=l.z,c=this.almostEqual(0,e,i,this.wrapTolerance),d=this.almostEqual(0,t,o,this.wrapTolerance),m=this.almostEqual(0,s,n,this.wrapTolerance);c&&d&&m?(this.addAtom(r,new THREE.Vector3(1,0,0),h,a),this.addAtom(r,new THREE.Vector3(0,1,0),h,a),this.addAtom(r,new THREE.Vector3(0,0,1),h,a),this.addAtom(r,new THREE.Vector3(1,1,0),h,a),this.addAtom(r,new THREE.Vector3(0,1,1),h,a),this.addAtom(r,new THREE.Vector3(1,0,1),h,a),this.addAtom(r,new THREE.Vector3(1,1,1),h,a)):c&&d&&!m?(this.addAtom(r,l.clone().add(new THREE.Vector3(1,0,0)),h,a),this.addAtom(r,l.clone().add(new THREE.Vector3(0,1,0)),h,a),this.addAtom(r,l.clone().add(new THREE.Vector3(1,1,0)),h,a)):!c&&d&&m?(this.addAtom(r,l.clone().add(new THREE.Vector3(0,1,0)),h,a),this.addAtom(r,l.clone().add(new THREE.Vector3(0,0,1)),h,a),this.addAtom(r,l.clone().add(new THREE.Vector3(0,1,1)),h,a)):c&&!d&&m?(this.addAtom(r,l.clone().add(new THREE.Vector3(1,0,0)),h,a),this.addAtom(r,l.clone().add(new THREE.Vector3(0,0,1)),h,a),this.addAtom(r,l.clone().add(new THREE.Vector3(1,0,1)),h,a)):!c||d||m?c||!d||m?c||d||!m||this.addAtom(r,l.clone().add(new THREE.Vector3(0,0,1)),h,a):this.addAtom(r,l.clone().add(new THREE.Vector3(0,1,0)),h,a):this.addAtom(r,l.clone().add(new THREE.Vector3(1,0,0)),h,a)}}}createBonds(){let e=this.atomPos.length;this.bondFills=[];for(let t=0;t<e;++t)for(let s=0;s<e;++s)if(s>t){let e=this.atomPos[t],i=this.atomPos[s],o=this.atomNumbers[t],n=this.atomNumbers[s],a=i.clone().sub(e).length(),l=this.options.radiusScale*this.elementRadii[o],r=this.options.radiusScale*this.elementRadii[n];a<=1.1*this.options.bondScale*(l+r)&&this.addBond(t,s,e,i)}}translate(e){let t=(new THREE.Vector3).fromArray(e);this.atoms.position.add(t),this.bonds.position.add(t),this.render()}setZoom(e){this.camera.zoom=e,this.render()}almostEqual(e,t,s,i){let o=t-e;return Math.abs(s.clone().multiplyScalar(o).length())<i}addBond(e,t,s,i){let o=new THREE.MeshPhongMaterial({color:16777215}),n=this.createCylinder(s,i,.075,10,o);n.name="fill",this.bondFills.push(n);let a=new THREE.MeshBasicMaterial({color:0,side:THREE.BackSide}),l=this.createCylinder(s,i,.09499999999999999,10,a);l.name="outline";let r=new THREE.Group;r.name="bond"+e+"-"+t,r.add(n),r.add(l),this.bonds.add(r)}createAtom(e,t,s,i=!0){if(!(t in s)){let e=this.options.radiusScale*this.elementRadii[t],i=165,o=Math.ceil(360/(180-i)),n=this.elementColors[t],a=new THREE.SphereGeometry(e,o,o),l=new THREE.MeshPhongMaterial({color:n}),r=new THREE.Mesh(a,l),h=.03/e+1,c=new THREE.SphereGeometry(e*h,o,o),d=new THREE.MeshBasicMaterial({color:0,side:THREE.BackSide}),m=new THREE.Mesh(c,d);s[t]={atom:r,outline:m}}let o=s[t],n=new THREE.Vector3;i?(n.add(this.basisVectors[0].clone().multiplyScalar(e.x)),n.add(this.basisVectors[1].clone().multiplyScalar(e.y)),n.add(this.basisVectors[2].clone().multiplyScalar(e.z))):n.copy(e);let a=o.atom.clone();a.position.copy(n);let l=o.outline.clone();return l.position.copy(n),[a,l,n]}addAtom(e,t,s,i,o=!0){let n=this.createAtom(t,s,i,o),a=n[0],l=n[1],r=n[2],h=new THREE.Group;h.name="atom"+e,a.name="fill",l.name="outline",h.add(a),h.add(l),this.atoms.add(h),this.atomFills.push(a),this.atomOutlines.push(l),this.atomPos.push(r),this.atomNumbers.push(s)}render(){let e=this.rootElement,t=e.clientWidth,s=e.clientHeight,i=new THREE.Vector3(1,0,0),o=new THREE.Vector3(0,0,0),n=[i,o];for(let e=0;e<n.length;++e){let i=n[e];this.camera.localToWorld(i),i.project(this.camera),i.x=Math.round((i.x+1)*t/2),i.y=Math.round((1-i.y)*s/2)}let a=(new THREE.Vector3).subVectors(o,i).length(),l=8/Math.pow(a,.5);if(void 0!==this.axisLabels)for(let e=0;e<this.axisLabels.length;++e){this.axisLabels[e].scale.set(l,l,1)}super.render()}setup0D(e,t,s){this.createConventionalCell([!1,!1,!1],this.options.showCell),this.createPrimitiveCell([!1,!1,!1],this.options.showCell),this.createAtoms(e,s,!1),this.createBonds(),this.createCornerPoints(new THREE.Vector3,this.basisVectors),this.createLatticeParameters(this.basisVectors,[!1,!1,!1])}setup1D(e,t,s,i,o){let n=o[0],a=new THREE.Vector3;a.setComponent(n,1);let l=this.basisVectors[n].clone(),r=this.getRepetitions(l,15),h=[],c=[];for(let t=1;t<=r;++t){let i=a.clone().multiplyScalar(t);for(let t=0;t<e.length;++t){let o=(new THREE.Vector3).copy(e[t]);o.add(i);let n=s[t];h.push(o),c.push(n)}let o=a.clone().multiplyScalar(-t);for(let t=0;t<e.length;++t){let i=(new THREE.Vector3).copy(e[t]);i.add(o);let n=s[t];h.push(i),c.push(n)}}e.push.apply(e,h),s.push.apply(s,c),this.options.showCell&&(this.createConventionalCell(i),this.createPrimitiveCell(i)),this.createAtoms(e,s,!1),this.createBonds();let d=[];d.push(this.basisVectors[0].clone()),d.push(this.basisVectors[1].clone()),d.push(this.basisVectors[2].clone()),d[n].multiplyScalar(2*r+1);let m=new THREE.Vector3;m.add(l.multiplyScalar(-r)),this.createCornerPoints(m,d),this.createLatticeParameters(this.basisVectors,i),this.setupInitialView1D(i)}getRepetitions(e,t){let s=e.length();return Math.max(Math.floor(t/s)-1,1)}setup2D(e,t,s,i,o){let n=o[0],a=o[1],l=new THREE.Vector3;l.setComponent(n,1);let r=new THREE.Vector3;r.setComponent(a,1);let h=this.basisVectors[n].clone(),c=this.basisVectors[a].clone(),d=0,m=0;this.options.allowRepeat&&(d=this.getRepetitions(h,12),m=this.getRepetitions(c,12));let p=[],u=[];for(let t=0;t<=d;++t)for(let i=0;i<=m;++i)if(0!=t||0!=i){let o=l.clone().multiplyScalar(t),n=r.clone().multiplyScalar(i);for(let t=0;t<e.length;++t){let i=(new THREE.Vector3).copy(e[t]);i.add(o),i.add(n);let a=s[t];p.push(i),u.push(a)}}e.push.apply(e,p),s.push.apply(s,u),this.createConventionalCell(i,this.options.showCell),this.createPrimitiveCell(i,this.options.showCell),this.createAtoms(e,s,!1),this.createBonds();let E=[];E.push(this.basisVectors[0].clone()),E.push(this.basisVectors[1].clone()),E.push(this.basisVectors[2].clone()),E[n].multiplyScalar(d+1),E[a].multiplyScalar(m+1),this.createCornerPoints(new THREE.Vector3,E),this.createLatticeParameters(this.basisVectors,i,o),this.setupInitialView2D(i,o)}setup3D(e,t,s){this.createConventionalCell([!0,!0,!0],this.options.showCell),this.createPrimitiveCell([!0,!0,!0],this.options.showCell),this.createAtoms(e,s,this.options.showCopies),this.createBonds(),this.createCornerPoints(new THREE.Vector3,this.basisVectors),this.createLatticeParameters(this.basisVectors,[!0,!0,!0]),this.setupInitialView3D()}}window.onload=function(){document.getElementById("tab1").onclick=function(){ae("tab1")},document.getElementById("tab2").onclick=function(){ae("tab2")},document.getElementById("tab3").onclick=function(){ae("tab3")},document.getElementById("tab4").onclick=function(){ae("tab4")},document.getElementById("tab5").onclick=function(){ae("tab5")}};let o=document.getElementById("canvas");var n=new i(o,{showParam:!1,showCopies:!1,showShadows:!0,showTags:!0,allowRepeat:!1,showCell:!1,wrap:!1,showLegend:!1,showOptions:!1,showUnit:!0,showBonds:!0,radiusScale:.7,bondScale:1.5,enableZoom:!1,enablePan:!1,enableRotate:!0,translation:[2.5,2.5,2.5],zoomLevel:.5});n.load(STRUCTURE);let a=[-50,-50,-50,-50];let l=function(e,t,s){return function(i,o){let n=math.dotPow(math.dotDivide(math.sin(math.dotMultiply(math.dotDivide(Math.PI,t),math.subtract(i,o))),s),2);return e*math.exp(-.5*math.sum(n))}}(45.693562016361284,[360,120,360,360],[.5903924170903855,2.7336270953356148,.938191844517205,.5856140739596537]),r=new class{constructor(e,t,s){this.kernel=e,this.noise_var=t,this.mean=s}fit(e,t){this.x_train=e;let s=t.length,i=this.K(e,this.kernel),o=math.transpose(t),n=math.subtract(o,this.mean),a=math.inv(math.add(i,math.dotMultiply(this.noise_var,math.identity(s))));this.y_train_trans_minus_mean_times_inverse=math.multiply(n,a)}predict(e){let t=this.k_vector(e,this.x_train,this.kernel),s=math.multiply(this.y_train_trans_minus_mean_times_inverse,t);return this.mean+s.get([0])}k_vector(e,t,s){let i=[];for(let o=0;o<t.length;++o){let n=s(e,t[o]);i.push(n)}return i}K(e,t){let s=t(e[0],e[0]),i=math.zeros(e.length);for(let o=0;o<e.length;++o)for(let n=0;n<e.length;++n)if(o==n)i.set([o,n],s);else if(n>o){let s=t(e[o],e[n]);i.set([o,n],s),i.set([n,o],s)}return i}}(l,2.061153622438558e-9,31.645791993529627);r.fit([[130,130,130,130],[220,40,220,40],[40,220,40,220],[85,85,175,-5],[265,265,-5,175],[175,-5,85,85],[-5,175,265,265],[17.5,62.5,62.5,197.5],[197.5,242.5,242.5,17.5],[287.5,-27.5,152.5,287.5],[107.5,152.5,-27.5,107.5],[62.5,17.5,287.5,152.5],[242.5,197.5,107.5,-27.5],[152.5,107.5,17.5,242.5],[-27.5,287.5,197.5,62.5],[-19.0314526796,-41.9668124758,191.5811989559,192.4597815896],[80.2762919361,149.5333580683,149.0198857444,196.0383021744],[110.5208519885,86.3350277295,99.9518171791,188.2950515186],[48.2660688529,151.6325048456,65.8373914382,-29.847056594],[-9.5792481174,-38.5083956357,29.2911580182,28.6769878441],[118.2943907058,213.3121956756,308.2390770858,308.3278632192],[259.4933827465,81.7928322488,260.8877721815,114.207451408],[182.2810187579,27.6899638376,201.5479580337,297.5792727937],[310,168.3312053518,275.2104241683,-10.9893315046],[-12.8627030251,181.3339539495,72.3178745576,135.3019300317],[145.6290707528,302.4341757308,284.7540348788,209.0141709938],[101.6207367013,85.7922117319,287.0933227515,59.71326191],[108.5119132439,65.3072354804,139.5912559206,254.0337198149],[253.2084600745,246.231305657,186.0083632249,236.2540031082],[146.0358340721,168.1058895181,6.8366488455,5.3431437117],[278.4796811259,136.1491590136,-21.8918459946,68.4151836047],[246.3031229395,46.3538471546,31.0642996133,284.2370513048],[85.646042421,258.3661457657,99.575826643,43.6408459401],[191.5435943997,55.4678676411,207.662710806,153.8408764837],[181.6573308758,93.7477187749,7.3870329356,136.3171654317],[-50,19.8577836914,109.6258188102,5.8132976085],[149.0724012466,-4.0349941993,246.6487316083,271.8212521492],[164.0528494905,14.0198216057,228.3621578621,86.003606593],[15.5900492559,132.3029695122,78.8023486509,264.9847459353],[225.2556039769,65.5961248445,108.3401838726,214.1426150854],[224.8815406175,213.4014914234,113.4539265347,50.2678505121],[310,109.2507984097,-1.6620974209,-14.7661043142],[310,112.8779524118,130.5568879943,158.0219393918],[30.2882719288,221.9119708269,173.3596195545,100.2904019692],[301.220793711,250.7025825873,292.5271876176,-50],[154.3523805248,178.7367256653,36.0857908832,68.1345628327],[187.1915860495,124.4887690864,199.1405414121,-26.842737687],[217.7664815554,121.0402111175,247.8289969382,184.4447079144],[221.2180738208,170.4585831665,139.3139354894,98.4520866028],[-30.2491323883,142.4880195955,-39.100958902,230.7319380938],[11.9961789006,80.8834963481,-49.7668486761,171.9103293774],[-11.4663686618,-43.4508616292,226.5123798134,-46.9417937462],[22.4815292394,27.8294819987,310,26.2096133233],[89.4680850352,-12.2057220407,61.7265453065,300.9770417409],[310,264.2721118607,209.5687325134,124.2032893038],[21.6596689227,229.4519109355,-17.5158004836,276.2279645338],[27.4607554113,97.5541234264,258.9799430798,232.4928460087],[117.3642420699,104.6430778267,73.9350041347,-1.01165443],[-35.1874283561,88.950966081,14.4107061403,97.0677809071],[166.9149222307,-4.7424773069,4.5802014234,39.3927326268],[46.1819712979,258.2628158816,144.5861195279,310],[39.2148685068,-9.625257745,185.3526489319,36.394339015],[247.696321503,203.9003130921,-50,252.0743540777],[70.3788436133,245.3873422319,39.3278403961,160.8926011081],[63.4071613845,216.0514989117,208.0106170846,144.7676247219],[310,124.9872654586,-25.1116606487,133.3314912615],[247.1411656045,310,309.5760551159,27.8084748803],[244.6291755402,22.5135542835,49.4045502129,114.6950615479],[192.9897783598,133.000171557,109.7591355067,272.5937829306],[194.4218239616,136.0976978242,15.4993773773,-39.7378909838],[87.9031884426,236.4006317412,277.1473475373,-17.8378818006],[126.8257750473,233.8218215742,-16.7117501181,196.8836452581],[115.832002795,36.953407821,310,254.2156535405],[-2.9643780471,32.6735826071,87.1734545203,83.8928534381],[13.4153853325,44.6390359475,267.2517615923,91.740472355],[-3.4704330858,111.7724796425,127.1256323507,224.8240931385],[175.2982944162,175.0066362961,147.9814515625,18.9662944352],[261.4586873393,121.5118516805,67.6870298056,194.7766860487],[145.8654957826,218.5074591216,189.5964568182,212.7614993672],[-50,110.1340973686,255.6030458491,53.9670309068],[51.8442058979,185.4416174978,138.7408156266,171.9756444331],[291.5265058821,175.4784428309,145.0740725408,183.067427334],[169.2010037567,167.8248894916,51.6032304023,177.916121393],[54.3880804936,-46.6830614487,21.9373590549,78.2936050347],[-36.8042353873,191.2019524939,47.009621934,274.2589834783],[282.3816431141,308.1775425317,119.4792790644,60.7256619736],[129.5057678968,265.9884318068,139.8555830957,-42.5735046518],[264.056841124,119.8665652903,201.5971099457,2.1726335133],[89.4718876479,291.4135939308,188.6320144397,91.161971666],[61.3783589479,58.1569287157,257.6223685408,295.8821668245],[201.8104464121,310,281.832830159,-50],[203.4094859596,264.5783987799,-32.6202327047,228.5420365381],[11.683198585,18.9673601488,203.154445795,173.83014581],[127.6019115279,30.8516792895,228.8582291555,24.4304019365],[203.7158399204,277.8097198883,-46.7204589999,103.5618090171],[230.5986827315,270.2031065978,59.0752565399,20.185679737],[76.7209792666,301.2198438692,-13.0207979679,205.8988464292],[281.3060376205,49.6051778551,251.9817968139,231.3706606037],[19.0078883606,-38.5277910011,106.3376764074,310],[127.1159872292,98.6101055351,159.521817158,66.4884040609],[131.9965672558,195.3764682233,256.8428575928,132.2396648235],[168.8871153435,193.6666610714,71.876247352,301.7649591421],[-36.5756246967,37.1270494512,156.7313785273,288.7227687024],[226.4939493953,236.999780386,145.5165139876,148.9624609447],[21.8959693111,121.1582631395,-6.1584732536,100.7084748707],[-9.5528198774,277.8550915683,.9494006255,-39.4009946313],[34.3380805768,-38.9280913021,-50,-9.7963445508],[263.9098938756,77.4439231274,42.9375216089,154.510999606],[14.1875569422,53.0496679088,150.5363391889,7.4080434722],[250.1779534124,59.7409975741,215.6933670551,292.408593872],[89.4283400722,110.0331176868,217.1179414976,249.7177055835],[-3.5238531786,249.0224449528,241.2537682083,-9.8843872905],[93.9082861804,94.8084288173,74.1430471921,106.0036317899],[113.4720838118,160.1502539252,224.2833983772,178.0689551931],[263.0295212459,242.9417686279,170.7522228576,85.2468971943],[-50,108.7379487888,263.8933656736,183.2068994777],[81.2851602941,120.4060931103,6.1785795908,24.7419232752],[32.6608365014,178.5045601964,176.9631045086,250.257011961],[171.0523047126,310,278.9036879774,55.4970205887],[282.4523971071,246.364704793,69.20566972,-49.9121272726],[214.380274007,-26.088196134,25.77483621,211.1114970798],[-28.0948056637,2.700833105,29.1452478997,183.0320231867],[259.8037351077,-37.2531366603,204.2058111233,172.2352160757],[155.8012850772,24.4833861835,112.4785928924,220.3057321527],[282.7469376733,307.524558987,42.0435553013,12.666652621],[100.8802067433,157.4548647393,53.7635657708,233.2632303703],[-40.2968661956,116.0693596827,215.2582547229,254.3300846179],[224.0052380952,-36.3563666089,9.301968261,73.0537026977],[289.8835184751,282.0652126867,95.8000082667,246.2040640091],[136.9579775132,188.1028894946,228.6948766964,-33.6473335465],[74.8226496548,169.7102453262,1.2190497483,301.5781214431],[-27.6912234408,185.5092531493,-42.9156621995,67.9348002231],[246.8925368768,266.5412267088,-28.8639073644,-27.3041371615],[33.2588071354,218.5526056261,95.5853106012,34.2977135356]],[[32.9358],[38.299],[25.513],[27.3085],[25.2292],[36.5772],[36.0907],[20.8058],[36.6902],[35.1168],[36.5209],[29.2388],[25.3631],[33.5159],[35.3341],[21.7047],[20.3567],[22.122],[29.9342],[33.0755],[41.633],[36.3537],[33.3932],[31.1396],[27.2025],[26.1395],[37.677],[32.9566],[35.0379],[29.5778],[33.775],[39.0221],[32.7151],[22.3225],[26.0402],[31.6115],[38.1059],[37.7777],[37.8335],[27.0334],[37.4949],[26.9178],[24.1241],[33.9622],[43.5431],[30.5971],[32.4926],[28.5634],[37.3359],[33.7029],[24.5153],[34.0032],[33.8533],[35.3912],[30.8339],[39.2682],[29.7507],[35.523],[35.7464],[33.5298],[32.6215],[31.6723],[41.4744],[22.6112],[22.341],[30.5412],[35.1349],[38.5446],[35.1271],[34.7399],[35.6071],[27.7549],[38.608],[37.3609],[36.1178],[31.3025],[26.1876],[29.5485],[24.2261],[36.1404],[16.5019],[18.4291],[20.6843],[32.1882],[32.4194],[34.8938],[30.9258],[37.3132],[32.8267],[31.8763],[38.7379],[33.8449],[21.9838],[32.1132],[37.0959],[24.041],[20.9967],[31.0359],[33.8553],[37.5483],[29.0233],[33.6583],[35.8309],[30.7437],[37.6538],[31.162],[30.4014],[27.8455],[29.2737],[39.7354],[32.4718],[32.8069],[33.1793],[20.2358],[41.6384],[23.3047],[30.7261],[29.4639],[36.7306],[29.3138],[29.588],[24.8393],[24.4749],[28.7207],[18.7222],[29.4482],[36.212],[33.1154],[29.1242],[30.5402],[31.7351],[33.1649],[37.6243],[31.502]]);let h=n.atoms.getObjectByName("atom0"),c=n.atoms.getObjectByName("atom2"),d=n.atoms.getObjectByName("atom3"),m=n.atoms.getObjectByName("atom4"),p=n.atoms.getObjectByName("atom5"),u=n.atoms.getObjectByName("atom6"),E=n.atoms.getObjectByName("atom7"),g=n.atoms.getObjectByName("atom8"),w=n.atoms.getObjectByName("atom9"),b=n.atoms.getObjectByName("atom11"),y=n.atoms.getObjectByName("atom12"),f=n.atoms.getObjectByName("atom10"),T=n.bonds.getObjectByName("bond0-2"),R=n.bonds.getObjectByName("bond0-5"),H=n.bonds.getObjectByName("bond0-9"),v=n.bonds.getObjectByName("bond2-3"),V=n.bonds.getObjectByName("bond2-4"),C=n.bonds.getObjectByName("bond5-6"),S=n.bonds.getObjectByName("bond5-7"),x=n.bonds.getObjectByName("bond5-8"),M=n.bonds.getObjectByName("bond9-11"),P=n.bonds.getObjectByName("bond9-10"),B=n.bonds.getObjectByName("bond11-12");function A(e,t,s,i,o=!1){let a,l,r=new THREE.Group,h=new THREE.Vector3;t.getObjectByName("fill").getWorldPosition(h),r.position.copy(h),o?(a=new THREE.Vector3,l=new THREE.Vector3,s.getObjectByName("fill").getWorldPosition(a),i.getObjectByName("fill").getWorldPosition(l)):(a=s.getObjectByName("fill").position,l=i.getObjectByName("fill").position);let c=(new THREE.Vector3).subVectors(l,a).normalize();for(let t of e)r.attach(t);return{group:r,axis:c,func:function(e){r.rotateOnWorldAxis(c,THREE.Math.degToRad(e)),n.render()}}}T.getObjectByName("fill").material.color.setHex(65280),M.getObjectByName("fill").material.color.setHex(7818433),R.getObjectByName("fill").material.color.setHex(16740876),H.getObjectByName("fill").material.color.setHex(0),n.render();let L=A([b,y,B],b,w,b,!0),O=L.group,N=(L.axis,L.func),z=A([w,f,M,P],w,h,w),j=z.group,I=(z.axis,z.func),W=A([p,u,E,g,C,S,x],p,h,p),D=W.group,G=(W.axis,W.func),F=A([c,d,m,v,V],c,h,c),k=F.group,q=(F.axis,F.func);j.attach(O),n.atoms.attach(j),n.atoms.attach(k),n.atoms.attach(D);let _=document.getElementById("energy-value"),U=document.getElementById("energy-min-value"),Q=document.getElementById("energy-slider-knob"),Z=document.getElementById("energy-slider-min-knob");var K=0,X=0,Y=0,J=0;let $=50.697;function ee(e,t,s,i){let o=[e,t,s,i];o=math.add(o,a);let n=r.predict(o);_.innerHTML=n.toFixed(2);let l=(n-13.905)/36.792*100;Q.style.left=l+"%",n<$&&te(n)}function te(e){let t=(e-13.905)/36.792*100;Z.style.left=t+"%",$=e,U.innerHTML=$.toFixed(2)}ee(J,Y,K,X);let se=document.getElementById("d11");se.oninput=function(){I(this.value-K),K=this.value,ee(J,Y,K,X)};let ie=document.getElementById("d13");ie.oninput=function(){N(this.value-X),X=this.value,ee(J,Y,K,X)};let oe=document.getElementById("d7");oe.oninput=function(){G(this.value-Y),Y=this.value,ee(J,Y,K,X)};let ne=document.getElementById("d4");function ae(e){var t,s,i;for(s=document.getElementsByClassName("content-tab"),t=0;t<s.length;t++)s[t].style.display="none";for(i=document.getElementsByClassName("tab"),t=0;t<s.length;t++)i[t].className=i[t].className.replace(" is-active","");document.getElementById(e+"-content").style.display="block",document.getElementById(e).className+=" is-active"}ne.oninput=function(){q(this.value-J),ee(J=this.value,Y,K,X)},document.getElementById("reset").onclick=function(){ne.value="0",ne.oninput(),oe.value="0",oe.oninput(),se.value="0",se.oninput(),ie.value="0",ie.oninput(),te(r.predict(a)),n.controls.reset(),ae("tab1")}}]);